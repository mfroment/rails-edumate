<div class="container fill pt-3">
  <% if @user == current_user %>
    <h1>Hello, <%= @user.first_name %></h1>
    <% article = "My" %>
  <% else %>
    <h1><%= user_full_name(@user) %></h1>
    <% article = "Their" %>
  <% end %>

  <!-- JS Tabs -->
  <ul class="lesson-tabs">
    <li>
      <a href="javascript:rudrSwitchTab('tb_1', 'content_1');" id="tb_1" class="tabmenu active">My Classes</a>
    </li>
    <li>
      <a href="javascript:rudrSwitchTab('tb_2', 'content_2');" id="tb_2" class="tabmenu">My Teachings</a>
    </li>
    <% if @user == current_user %>
    <li>
      <%= link_to "Edit profile", edit_user_path(@user) %>
    </li>
    <% end %>
  </ul>

  <!-- sort user lessons by time, reverse order  -->
  <% if @user == current_user %>
  <div id="content_1" class="tabcontent">
    <p><%= article %> Upcoming Bookings</p>
    <% @user.bookings.sort_by { |booking| booking.lesson[:time] }.reverse.each do |booking| %>
      <% if booking.lesson.time.to_f > Time.now.to_f %>
        <%= render 'lessons/card', lesson: booking.lesson %>
      <% end %>
    <% end %>
    <p><%= article %> Past Bookings</p>
    <% @user.bookings.sort_by { |booking| booking.lesson[:time] }.reverse.each do |booking| %>
        <% if booking.lesson.time.to_f < Time.now.to_f %>
          <div class="faded">
            <%= render 'lessons/card', lesson: booking.lesson %>
          </div>
        <% end %>
    <% end %>
  <% end %>

  </div>


  <div id="content_2" class="tabcontent" style="display:none;">
    <p><%= article %> Upcoming Teachings</p>
    <% @user.lessons_as_teacher.order(time: :asc).each do |lesson| %>
      <% if lesson.time.to_f > Time.now.to_f %>
        <%= render 'lessons/card', lesson: lesson %>
      <% end %>
    <% end %>

    <p><%= article %> Past Teachings</p>
    <% @user.lessons_as_teacher.order(time: :desc).each do |lesson| %>
      <% if lesson.time.to_f < Time.now.to_f %>
        <div class="faded">
          <%= render 'lessons/card', lesson: lesson %>
        </div>
      <% end %>

    <% end %>
  </div>
</div>

<script>
  //tab function
function rudrSwitchTab(rudr_tab_id, rudr_tab_content) {
  var x = document.getElementsByClassName("tabcontent");
  var i;
  for (i = 0; i < x.length; i++) {
    x[i].style.display = 'none';
  }
  document.getElementById(rudr_tab_content).style.display = 'block';
  var x = document.getElementsByClassName("tabmenu");
  var i;
  for (i = 0; i < x.length; i++) {
    x[i].className = 'tabmenu';
  }
  document.getElementById(rudr_tab_id).className = 'tabmenu active';
}
</script>









